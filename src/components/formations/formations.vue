<template>
	<div class="relative">
		<pagination 
			:current="pages[0].current" 
			:last="pages[0].lastPage" 
			url="home/" 
			@home="updateFormations" 
			@loading="loading = true"
		></pagination>
		<div class="full">
			<transition :name="transition" mode="out-in">
				<div :key="formations[0].id">
					<div class="col-xs-12 col-sm-6 col-lg-4 margin-bot-50" v-for="formation in formations">
						<formation :data="formation" ></formation>
					</div>
				</div>
				</transition>
			</transition>
			<div class="clear"></div>
		</div>
		<pagination 
			:current="pages[0].current" 
			:last="pages[0].lastPage" 
			url="home/" 
			@home="updateFormations" 
			@loading="loading = true"
		></pagination>
		<div class="loading"></div>
	</div>
</template>

<script>
	import formation from './formation.vue'
	import pagination from '../pagination.vue'

	export default {
		components: { formation, pagination },
		props: ['data'],
		data() {
			return {
				formations: this.data.filter(item => !item.hasOwnProperty('current')),
				pages: this.data.filter(item => item.hasOwnProperty('lastPage')),
				direction: '',
				loading: true
			}
		},
		methods: {
			updateFormations(data) {
				this.formations = data.filter(item => !item.hasOwnProperty('current'))
				let newPages = data.filter(item => item.hasOwnProperty('current'))
				if(this.pages[0].current > newPages[0].current)
					this.direction = 'right'
				else
					this.direction = 'left'
				this.pages = newPages 
			}
		},
		computed: {
			transition() {
				return "slide-"+this.direction
			}
		}
	}
</script>

<style>
	.full {
		overflow-x:hidden;
	}
	.slide-left-enter-active {
		animation: slide-left-in .8s;
		animation-timing-function: ease-out;
	}
	.slide-left-leave-active {
		animation: slide-left-out .5s;
		animation-timing-function: linear;
	}
	@keyframes slide-left-in {
		0% {
			transform: translateX(100%);
		}
		50% {
			transform: translateX(-40%);
		}
		100% {
			transform: translateX(0%);
		}
	}
	@keyframes slide-left-out {
		0% {
			transform: translateX(0%);
		}
		100% {
			transform: translateX(-100%);
		}
	}

	.slide-right-enter-active {
		animation: slide-right-in .8s;
		animation-timing-function: ease-out;
	}
	.slide-right-leave-active {
		animation: slide-right-out .5s;
		animation-timing-function: linear;
	}
	@keyframes slide-right-in {
		0% {
			transform: translateX(-100%);
		}
		50% {
			transform: translateX(40%);
		}
		100% {
			transform: translateX(0%);
		}
	}
	@keyframes slide-right-out {
		0% {
			transform: translateX(0%);
		}
		100% {
			transform: translateX(100%);
		}
	}
/*	.loading {
		background: red;
		position: absolute;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
	}*/
	.relative {
		position: relative;
	}
</style>